// Single DOMContentLoaded orchestrating all setup
document.addEventListener('DOMContentLoaded', () => {
  setupMobileNav();
  loadLogoInline();
  setupContactForm();
});

function setupMobileNav() {
  const burger = document.getElementById('hamburger');
  const menu = document.getElementById('nav-menu');
  if (!burger || !menu) return;
  burger.addEventListener('click', () => {
    const isOpen = menu.style.display === 'flex';
    menu.style.display = isOpen ? 'none' : 'flex';
    menu.style.flexDirection = 'column';
    menu.style.gap = '12px';
    menu.style.padding = '12px 0';
  });
}

async function loadLogoInline() {
  const mount = document.getElementById('logo');
  if (!mount) return;
  try {
    const logoPath = 'images/ProtoCore.svg';
    const res = await fetch(encodeURI(logoPath), { cache: 'no-cache' });
    if (!res.ok) throw new Error(`SVG not found: ${res.status}`);
    const svg = await res.text();
    mount.innerHTML = svg;

    const svgEl = mount.querySelector('svg');
    if (!svgEl) return;
    const root  = svgEl?.querySelector('#Protocore') || svgEl;
    try {
      const b = root.getBBox();
      const pad = 20;
      const x = b.x - pad;
      const y = b.y - pad;
      const w = b.width + pad * 2;
      const h = b.height + pad * 2;
      svgEl.setAttribute('viewBox', `${x} ${y} ${w} ${h}`);
      svgEl.setAttribute('preserveAspectRatio', 'xMidYMid meet');
      svgEl.removeAttribute('width');
      svgEl.removeAttribute('height');
    } catch (e) {
      console.warn('Kon viewBox niet trimmen:', e);
    }

    ['Logo_x5F_Basis','Letter_x5F_E','Letter_x5F_Punt','Letter_x5F_TM'].forEach(id => {
      if (!svgEl.querySelector(`#${id}`)) console.warn(`Missing: #${id}`);
    });
  } catch (err) {
    console.error('Logo load error:', err);
    const fallback = 'images/ProtoCore.svg';
    mount.innerHTML = `<img src="${fallback}" alt="Protocore logo" style="max-width:100%;height:auto;" />`;
  }
}

function setupContactForm() {
  const form = document.getElementById('contactForm');
  if (!form) return;
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    alert('Bedankt! We nemen snel contact met je op.');
    form.reset();
  });
}
